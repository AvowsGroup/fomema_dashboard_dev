<!DOCTYPE html>
<html lang="en">
<head>
  <title>Fomema Dashboard</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://nios-uat.fomema.my/assets/application-c91769e8cc6c86f7aad7e6e6bf56853208c5f6dd99806a170cd9e5eb931003c9.css">
  <link rel="stylesheet" href="css/stylenew.css">
  <link rel="stylesheet" href="css/stylenew5.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
</head>
<body class="">
<div class="header">
  <nav class="navbar navbar-expand-md bg-light navbar-dark">
    <div class="admin-logo"><img src="img/logo.png"></div>
    <!-- Topbar Search -->
  </nav>
</div>
<div class="chard-box pt-2">
  <div class="chard-box">
    <div class="wrapper">
      <!-- Page Content  -->
      <div id="content">
        <div class="dashboard-body">
          <div class="container-fluid">
            <div class="row my-1">
              <div class="col-12">
                <main class="main">
                  <ol class="breadcrumb">
                    <a class="breadcrumb-item " href="/">Home </a>
                    <a class="breadcrumb-item active" href="https://nios-uat.fomema.my/foreign_workers">Audits</a>
                    <li class="breadcrumb-menu d-md-down-none">
                      <div class="btn-group" role="group" aria-label="Button group">
                        <!-- <a class="btn" href="#">
                           <i class="icon-speech"></i>
                           </a>
                           <a class="btn" href="/">
                           <i class="icon-graph"></i> &nbsp;Dashboard
                           </a>
                           <a class="btn" href="#">
                           <i class="icon-settings"></i> &nbsp;Settings
                           </a> -->
                      </div>
                    </li>
                  </ol>
                  <div class="container-fluid">
                    <div class="animated fadeIn">
                      <div class="card">
                        <div class="card-header">
                          <strong>Audits</strong>
                        </div>
                        <!-- card-body -->
                        <div class="card-body">
                          <div class="card">
                            <div class="card-header">
                              <strong> Filter</strong>
                            </div>
                            <div class="card-body">
                              <div class="row">
                                <div class="col-md-6">
                                  <div class="form-group row">
                                    <label for="code" class="col-sm-3 col-form-label">Date From</label>
                                    <div class="col-sm-9">
                                      <input type="date" id="dateFrom" class="form-control">
                                    </div>
                                  </div>
                                </div>
                                <div class="col-md-6">
                                  <div class="form-group row">
                                    <label for="code" class="col-sm-3 col-form-label">Date To</label>
                                    <div class="col-sm-9">
                                      <input type="date" id="dateTo" class="form-control">
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="card-footer">
                              <div class="text-right">
                                <button id="clearBtn" class="btn btn-sm btn-danger" title="Clear"> Clear</button>
                                <button id="submitBtn" class="btn btn-sm btn-primary" type="submit"> Submit</button>
                              </div>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-12 my-2">
                              <div class="row ">
                                <div class="col-md-12 my-2">
                                  <div class="table-responsive" style="height:100%; overflow-y:auto;">
                                    <table class="table table-bordered table-data">
                                      <thead>
                                      <tr>
                                        <th style="width: 4%;">No</th>
                                        <th style="width:10%;">ID</th>
                                        <th style="width:10%;">Version</th>
                                        <th style="width:20%;">User</th>
                                        <th style="width: 5%;">Type</th>
                                        <th style="width: 30%;">Date & Time</th>
                                        <th style="width: 20%;">Changed Fields</th>
                                        <th style="width: 20%;">Actions</th>
                                      </tr>
                                      </thead>
                                      <tbody id="AuditBody">
                                      <%= render partial: 'dashboards/dep_information/audit_logs_partial', locals: { filtered_records: @filtered_logs } %>
                                      </tbody>
                                    </table>
                                  </div>
                                </div>
                              </div>
                              <nav class="col">
                                <ul class="pagination">
                                  <li class="page-item active">
                                    <a class="page-link" href="/laboratories">1</a>
                                  </li>
                                  <li class="page-item">
                                    <a class="page-link" rel="next" href="/laboratories?page=2">2</a>
                                  </li>
                                  <li class="page-item">
                                    <a class="page-link" href="/laboratories?page=3">3</a>
                                  </li>
                                  <li class="page-item">
                                    <a class="page-link" href="/laboratories?page=4">4</a>
                                  </li>
                                  <li class="page-item">
                                    <a class="page-link" href="/laboratories?page=5">5</a>
                                  </li>
                                  <li class="page-item">
                                    <a rel="next" class="page-link" href="/laboratories?page=2">›</a>
                                  </li>
                                  <li class="page-item">
                                    <a class="page-link" href="/laboratories?page=42">»</a>
                                  </li>
                                </ul>
                              </nav>
                              <div class="input-group col justify-content-end">
                                <div class="input-group-prepend">
                                  <span class="input-group-text  btn-sm " id="basic-addon1" style="line-height: 10px;height: 25px;">Show per page</span>
                                </div>
                                <div class="dropdown">
                                  <button class="btn btn-sm btn-primary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    10
                                  </button>
                                  <div class="dropdown-menu " aria-labelledby="dropdownMenuButton">
                                    <a class="dropdown-item" href="https://nios-uat.fomema.my/laboratories?per=10">10</a>
                                    <a class="dropdown-item" href="https://nios-uat.fomema.my/laboratories?per=20">20</a>
                                    <a class="dropdown-item" href="https://nios-uat.fomema.my/laboratories?per=30">30</a>
                                    <a class="dropdown-item" href="https://nios-uat.fomema.my/laboratories?per=50">50</a>
                                    <a class="dropdown-item" href="https://nios-uat.fomema.my/laboratories?per=100">100</a>
                                    <a class="dropdown-item" href="https://nios-uat.fomema.my/laboratories?per=200">200</a>
                                    <a class="dropdown-item" href="https://nios-uat.fomema.my/laboratories?per=500">500</a>
                                    <a class="dropdown-item" href="https://nios-uat.fomema.my/laboratories?per=1000">1000</a>
                                    <a class="dropdown-item" href="https://nios-uat.fomema.my/laboratories?per=2000">2000</a>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <!-- /card-body -->
                      </div>
                    </div>
                  </div>
                </main>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</div>
</body>
</html>
<script>
    $(document).ready(function () {
        $('#submitBtn').on('click', function () {
            // Get selected values from the dropdowns
            var dateFrom = $('#dateFrom').val();
            var dateTo = $('#dateTo').val();
            console.log(dateFrom)
            console.log(dateTo)
            // Make an AJAX request to filter the data
            $.ajax({
                url: '/dashboards/department_configuration/filter_audit_logs',
                method: 'GET',
                data: {date_from: dateFrom, date_to: dateTo},
                success: function (data) {
                    // Replace the table body with the filtered data
                    $('tbody').html(data);
                },
                error: function () {
                    console.error('Error fetching filtered data.');
                }
            });
        });

        // Function to handle the clear button click
        $('#clearBtn').on('click', function () {
            // Reset selected values in the dropdowns
            $('#dateFrom').val('');
            $('#dateTo').val('');

            location.reload();
        });
    });
</script>
